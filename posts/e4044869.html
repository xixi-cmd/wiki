<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>爬虫被403怎么办</title><meta name="description" content="私のすべてを支配してください"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="https://upimage.alexhchu.com/2021/04/28/5a7401f88c1cf.png"><link rel="stylesheet" href="/xx/style/common/bulma.css"><link rel="stylesheet" href="/xx/style/base.css"><link rel="stylesheet" href="/xx/style/common/helper.css"><script src="/xx/js/common.js"></script><link rel="stylesheet" href="/xx/style/post.css"><link rel="stylesheet" href="/xx/style/themes/highlight-theme-light.css"><script src="/xx/js/highlight.pack.js"></script><meta name="description" content="403先来给不知道的同学们科普一下错误码，错误码有很多啊，比如404（最常见的），那么为啥这会返还一个我们不知道是什么的码呢？我们随便编辑一个Python爬虫程序
import requests

url = &amp;#39;https://cn.chen-shang.top&amp;#39; # 举个栗子
a = requests.get(url)
print(a)

拿我的博客网址举个例子，我们发现终端的输出为
Response &amp;lt;200&amp;gt;

看不懂？没关系，有一个规律，2打头的都是请求成功。200的看了，来看看404
import requests

url = &amp;#39;https://ccknbc.cc/405&amp;#39; # 菜狗的网址
a = requests.get(url)
print(a)
.."><meta name="generator" content="Hexo 5.4.0"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/xx/">AIENS.'s blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">爬虫被403怎么办</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/xx/">首页</a></h3><h3 class="is-inline-block"><a href="/xx/about">关于</a></h3><h3 class="is-inline-block"><a href="/xx/archives">归档</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/xx/">首页</a></h3><h3 class="is-inline-block"><a href="/xx/about">关于</a></h3><h3 class="is-inline-block"><a href="/xx/archives">归档</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#403"><span class="toc-text">403</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%B0%E5%9C%A8%EF%BC%8C%E9%87%8D%E7%82%B9%E5%88%86%E6%9E%90403%E6%98%AF%E4%B8%AA%E4%BB%80%E4%B9%88%E4%B8%9C%E8%A5%BF"><span class="toc-text">现在，重点分析403是个什么东西</span></a></li></ol></li></ol></div><div class="column is-9"><header class="my-4"><a href="/xx/tags/Python"><i class="tag post-item-tag">Python</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">爬虫被403怎么办</h1><time class="has-text-grey" datetime="2021-01-28T06:06:24.000Z">2021-01-28</time><article class="mt-2 post-content"><h1 id="403"><a href="#403" class="headerlink" title="403"></a>403</h1><p>先来给不知道的同学们科普一下错误码，错误码有很多啊，比如404（最常见的），那么为啥这会返还一个我们不知道是什么的码呢？<br>我们随便编辑一个Python爬虫程序</p>
<pre><code class="python">import requests

url = &#39;https://cn.chen-shang.top&#39; # 举个栗子
a = requests.get(url)
print(a)
</code></pre>
<p>拿我的博客网址举个例子，我们发现终端的输出为</p>
<pre><code class="BASH">Response &lt;200&gt;
</code></pre>
<p>看不懂？没关系，有一个规律，2打头的都是请求成功。200的看了，来看看404</p>
<pre><code class="python">import requests

url = &#39;https://ccknbc.cc/405&#39; # 菜狗的网址
a = requests.get(url)
print(a)
</code></pre>
<p>输出结果是什么</p>
<pre><code class="shell">Response &lt;404&gt;
</code></pre>
<p>也是一个道理，4打头都是请求失败，不搞5打头了，一个4打头找了我老半天。</p>
<h2 id="现在，重点分析403是个什么东西"><a href="#现在，重点分析403是个什么东西" class="headerlink" title="现在，重点分析403是个什么东西"></a>现在，重点分析403是个什么东西</h2><p>403这玩意4打头看得出来是报错了，为啥报错呢？权限不够，403错误是一种在网站访问过程中，常见的错误提示，表示资源不可用。服务器理解客户的请求，但拒绝处理它，通常由于服务器上文件或目录的权限设置导致的WEB访问错误。<br>现在很多网站的api接口返回httpcode返回码是403提示禁止访问。如果您也遇到这样的情况,请先不要急着去修改网站相关的参数<br>第一、先进api的网站。用浏览器访问，如果浏览器访问该api接口能成功。说明是设置了权限的问题。如果不能成功的话。很可以是该接口已修改或已失效，这时候就没办法访问了。<br>第二、如果浏览器能访问成功的话。那就好办了。调用该接口时，捕获异常中的responseBody，很有可能数据就在这里面，笔者就遇到的是这种问题。</p>
<p>也有可能是服务器看你不顺眼，把你挡在门外了，虽然我很喜欢用request，但是为了快，这次用 urllib3</p>
<pre><code class="python">import urllib.request as request
src=![&quot;https://www.ptt.cc/bbs/movie/index.html&quot;]
with request.urlopen(src) as response:
    data=response.read().decode(&#39;utf-8&#39;)
print(data)
</code></pre>
<p>在这种情况下直接对网路进行连接，一般情况下会被服务器拒绝出现这样的报错<br>“”“urllib.error.HTTPError: HTTP Error 403: Forbidden”“”</p>
<p>这种情况是网站认为你不是普通用户操作，所以我们需要模拟普通用户。<br>一般用户使用会给网站发送一个这总系统和浏览器的信息，所以我们需要模拟。也要向网站发送一个这样的信息。<br>遇到这样子的，主要是爬虫被发现了，建议用Python的正则表达式，放出我之前写的一个残次品，虽然没什么用，但是我就哪一个写了正则表达式</p>
<pre><code class="python"># coding = utf -8
import requests
import re
# url
url = &#39;https://www.tukuppt.com/yinxiao/&#39;
# The detection of IP
headers = &#123;
     &#39;User-Agent&#39;: &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 FS&#39;
&#125;
# data
a = requests.get(url)
a = &quot;&quot;&quot;&lt;a class=&quot;title&quot; target=&quot;_blank&quot; href=“.*?”&gt;(.*?)&lt;/a&gt;&quot;&quot;&quot;
b = &#39;&lt;source src=&quot;(.*?)&quot; type=&quot;audio/mpeg&quot;&gt;&#39;
urls = re.findall(a, b.text)
print(urls)

for url, name in zip(urls, name):
     music = requests.get(&#39;http&#39;+url,headers)
     with open(&#39;data.txt&#39;, &#39;w&#39;) as f:
          f.write(music.content)
     print(&#39;&lt;%s OK&gt;&#39; % name)
</code></pre>
<p>上面那个是我爬熊猫办公的。其实还可以更简单，就是找到你浏览器的User-Agent，像我的就是</p>
<pre><code class="Python">&#39;User-Agent&#39;: &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 FS&#39;
</code></pre>
<p>加入，如下是urllib3爬ptt的</p>
<pre><code class="python">#抓取PTT电影版的网页原始码（HTML）
import urllib.request as req
url=&quot;https://www.ptt.cc/bbs/movie/index.html&quot;
#建立一个Request物件，附加Request Headers 的资讯  
request=req.Request(url,headers=&#123;
    &quot;User-Agent&quot;:&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36&quot;
&#125;)
with req.urlopen(request) as response:
    data=response.read().decode(&quot;utf-8&quot;)
#资料解析
import bs4
root=bs4.BeautifulSoup(data,&quot;html.parser&quot;)
titles=root.find_all(&quot;div&quot;,class_=&quot;title&quot;)
print(titles)
</code></pre>
<Vssue  /></article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/xx/posts/eb490c78.html" title="turtle"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">上一页: turtle</span></a><a class="button is-default" href="/xx/posts/e4044868.html" title="JS逆向反调试和反反调试"><span class="has-text-weight-semibold">下一页: JS逆向反调试和反反调试</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com/shelby86443093"><i class="iconfont icon-twitter"></i></a><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/xixi-cmd"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><a title="zhihu" target="_blank" rel="noopener nofollow" href="//zhihu.com/people/chenshang-53"><i class="iconfont icon-zhihu"></i></a><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> AIENS. 2021</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/xx/js/post.js"></script></body></html>